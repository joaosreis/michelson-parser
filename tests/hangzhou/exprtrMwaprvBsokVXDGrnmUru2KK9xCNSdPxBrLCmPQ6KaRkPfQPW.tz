{ parameter (pair (pair (address %address_from) (address %address_to)) (nat %value)) ;
  storage
    (pair (pair (pair (address %admin) (address %thank_address))
                (pair (big_map %tokens address nat) (nat %total_supply)))
          (option %transfer_to address)) ;
  code { UNPAIR ;
         PUSH mutez 0 ;
         AMOUNT ;
         COMPARE ;
         NEQ ;
         IF { DROP 2 ; PUSH string "TezAmountNotZero" ; FAILWITH }
            { DUP ;
              CDR ;
              DUP 3 ;
              CAR ;
              CDR ;
              CAR ;
              DIG 2 ;
              CAR ;
              CAR ;
              GET ;
              IF_NONE { PUSH nat 0 } {} ;
              COMPARE ;
              LT ;
              IF { DROP ; PUSH string "Not Enough Balance" ; FAILWITH }
                 { DUP ;
                   CAR ;
                   CAR ;
                   CDR ;
                   CONTRACT %transfer (pair address (pair address nat)) ;
                   IF_NONE { PUSH string "NO_CONTRACT_FOUND" ; FAILWITH } {} ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CDR ;
                   IF_NONE
                     { DROP ; PUSH string "NO_RECIPIENT" ; FAILWITH }
                     { SWAP ;
                       PUSH mutez 0 ;
                       PUSH nat 2000000000000000000 ;
                       DIG 3 ;
                       PAIR ;
                       DUP 4 ;
                       CAR ;
                       CAR ;
                       CAR ;
                       PAIR ;
                       TRANSFER_TOKENS } ;
                   NONE address ;
                   DIG 2 ;
                   CAR ;
                   PAIR ;
                   NIL operation ;
                   DIG 2 ;
                   CONS ;
                   PAIR } } } }
