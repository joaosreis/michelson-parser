{ parameter
    (or (or (or (or %admin (or (unit %confirm_admin) (bool %pause)) (address %set_admin))
                (nat %cancel_Bet))
            (or (nat %liquidate_Bet)
                (pair %make_Bet (bytes %hashed_secret) (pair (nat %amount) (nat %guess)))))
        (or (pair %resolve_Bet (nat %game_id) (bytes %revealed_secret))
            (pair %take_Bet (nat %game_id) (bytes %hashed_secret)))) ;
  storage
    (pair (option %pauseable_admin
             (pair (pair (address %admin) (bool %paused)) (option %pending_admin address)))
          (pair (pair %fa2_currency (address %fa2_address) (nat %token_id))
                (pair (map %active_game_info
                         nat
                         (pair (or %stage
                                  (or (unit %game_Resolved) (unit %maker_Committed))
                                  (or (unit %maker_Revealed) (unit %taker_Committed)))
                               (pair (address %maker)
                                     (pair (bytes %maker_hash)
                                           (pair (option %maker_secret bytes)
                                                 (pair (option %taker address)
                                                       (pair (option %taker_hash bytes)
                                                             (pair (option %taker_secret bytes)
                                                                   (pair (timestamp %start_time)
                                                                         (pair (nat %bet) (pair (nat %guess) (pair (nat %payout) (option %ended timestamp)))))))))))))
                      (pair (big_map %resolved_game_info
                               nat
                               (pair (or %stage
                                        (or (unit %game_Resolved) (unit %maker_Committed))
                                        (or (unit %maker_Revealed) (unit %taker_Committed)))
                                     (pair (address %maker)
                                           (pair (bytes %maker_hash)
                                                 (pair (option %maker_secret bytes)
                                                       (pair (option %taker address)
                                                             (pair (option %taker_hash bytes)
                                                                   (pair (option %taker_secret bytes)
                                                                         (pair (timestamp %start_time)
                                                                               (pair (nat %bet) (pair (nat %guess) (pair (nat %payout) (option %ended timestamp)))))))))))))
                            (pair (nat %current_game_id) (address %house_address)))))) ;
  code { LAMBDA
           (option (pair (pair address bool) (option address)))
           unit
           { IF_NONE
               { UNIT }
               { CAR ;
                 CAR ;
                 SENDER ;
                 COMPARE ;
                 NEQ ;
                 IF { PUSH string "NOT_AN_ADMIN" ; FAILWITH } { UNIT } } } ;
         LAMBDA
           (or (or unit unit) (or unit unit))
           bool
           { IF_LEFT
               { IF_LEFT { DROP ; PUSH bool False } { DROP ; PUSH bool True } }
               { IF_LEFT { DROP ; PUSH bool False } { DROP ; PUSH bool False } } } ;
         LAMBDA
           (or (or unit unit) (or unit unit))
           bool
           { IF_LEFT
               { IF_LEFT { DROP ; PUSH bool False } { DROP ; PUSH bool False } }
               { IF_LEFT { DROP ; PUSH bool False } { DROP ; PUSH bool True } } } ;
         LAMBDA
           (or (or unit unit) (or unit unit))
           bool
           { IF_LEFT
               { IF_LEFT { DROP ; PUSH bool False } { DROP ; PUSH bool False } }
               { IF_LEFT { DROP ; PUSH bool True } { DROP ; PUSH bool False } } } ;
         LAMBDA
           (pair bool string)
           unit
           { UNPAIR ; NOT ; IF { FAILWITH } { DROP ; UNIT } } ;
         LAMBDA
           (pair (pair address address) (pair nat (pair address nat)))
           operation
           { UNPAIR ;
             UNPAIR ;
             DIG 2 ;
             UNPAIR ;
             NIL (pair nat nat) ;
             SWAP ;
             DUP 3 ;
             CDR ;
             PAIR ;
             CONS ;
             SWAP ;
             CAR ;
             PAIR ;
             DIG 2 ;
             PAIR ;
             SWAP ;
             PAIR ;
             UNPAIR 3 ;
             DUP 3 ;
             CDR ;
             MAP { DUP 3 ; PAIR } ;
             DIG 2 ;
             DROP ;
             DIG 2 ;
             CAR ;
             CONTRACT %transfer
               (list (pair (address %from_)
                           (list %txs (pair (address %to_) (pair (nat %token_id) (nat %amount)))))) ;
             IF_NONE { PUSH string "Invalid FA2 Address" ; FAILWITH } {} ;
             PUSH mutez 0 ;
             NIL (pair address (list (pair address (pair nat nat)))) ;
             DIG 3 ;
             DIG 4 ;
             PAIR ;
             CONS ;
             TRANSFER_TOKENS } ;
         LAMBDA
           (pair bytes bytes)
           bool
           { UNPAIR ;
             SWAP ;
             SHA256 ;
             COMPARE ;
             NEQ ;
             IF { PUSH bool False } { PUSH bool True } } ;
         LAMBDA
           (pair nat
                 (pair (option (pair (pair address bool) (option address)))
                       (pair (pair address nat)
                             (pair (map nat
                                        (pair (or (or unit unit) (or unit unit))
                                              (pair address
                                                    (pair bytes
                                                          (pair (option bytes)
                                                                (pair (option address)
                                                                      (pair (option bytes)
                                                                            (pair (option bytes) (pair timestamp (pair nat (pair nat (pair nat (option timestamp)))))))))))))
                                   (pair (big_map
                                            nat
                                            (pair (or (or unit unit) (or unit unit))
                                                  (pair address
                                                        (pair bytes
                                                              (pair (option bytes)
                                                                    (pair (option address)
                                                                          (pair (option bytes)
                                                                                (pair (option bytes) (pair timestamp (pair nat (pair nat (pair nat (option timestamp)))))))))))))
                                         (pair nat address))))))
           (pair (or (or unit unit) (or unit unit))
                 (pair address
                       (pair bytes
                             (pair (option bytes)
                                   (pair (option address)
                                         (pair (option bytes)
                                               (pair (option bytes) (pair timestamp (pair nat (pair nat (pair nat (option timestamp))))))))))))
           { UNPAIR ;
             SWAP ;
             CDR ;
             CDR ;
             CAR ;
             SWAP ;
             GET ;
             IF_NONE
               { PUSH string "Game does not exist for given game_id" ; FAILWITH }
               {} } ;
         DIG 8 ;
         UNPAIR ;
         SWAP ;
         DUP ;
         DUG 2 ;
         CAR ;
         IF_NONE
           { UNIT }
           { CAR ; CDR ; IF { PUSH string "PAUSED" ; FAILWITH } { UNIT } } ;
         DROP ;
         PUSH string "Amount must be 0mutez" ;
         PUSH mutez 0 ;
         AMOUNT ;
         COMPARE ;
         EQ ;
         PAIR ;
         DUP 7 ;
         SWAP ;
         EXEC ;
         DROP ;
         SELF_ADDRESS ;
         SWAP ;
         IF_LEFT
           { DIG 4 ;
             DROP ;
             IF_LEFT
               { DIG 5 ;
                 DROP ;
                 DIG 5 ;
                 DROP ;
                 DIG 5 ;
                 DROP ;
                 IF_LEFT
                   { SWAP ;
                     DROP ;
                     DIG 2 ;
                     DROP ;
                     DIG 2 ;
                     DROP ;
                     DIG 2 ;
                     DROP ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     CAR ;
                     SWAP ;
                     IF_LEFT
                       { IF_LEFT
                           { DROP ;
                             DIG 2 ;
                             DROP ;
                             IF_NONE
                               { PUSH string "NO_ADMIN_CAPABILITIES_CONFIGURED" ; FAILWITH }
                               { DUP ;
                                 CDR ;
                                 IF_NONE
                                   { DROP ; PUSH string "NO_PENDING_ADMIN" ; FAILWITH }
                                   { SENDER ;
                                     COMPARE ;
                                     EQ ;
                                     IF { NONE address ; SWAP ; CAR ; CDR ; SENDER ; PAIR ; PAIR ; SOME }
                                        { DROP ; PUSH string "NOT_A_PENDING_ADMIN" ; FAILWITH } } } ;
                             NIL operation ;
                             PAIR }
                           { SWAP ;
                             DUP ;
                             DUG 2 ;
                             DIG 4 ;
                             SWAP ;
                             EXEC ;
                             DROP ;
                             SWAP ;
                             IF_NONE
                               { DROP ; PUSH string "NO_ADMIN_CAPABILITIES_CONFIGURED" ; FAILWITH }
                               { DUP ; CDR ; DUG 2 ; CAR ; CAR ; PAIR ; PAIR ; SOME } ;
                             NIL operation ;
                             PAIR } }
                       { SWAP ;
                         DUP ;
                         DUG 2 ;
                         DIG 4 ;
                         SWAP ;
                         EXEC ;
                         DROP ;
                         SWAP ;
                         IF_NONE
                           { DROP ; PUSH string "NO_ADMIN_CAPABILITIES_CONFIGURED" ; FAILWITH }
                           { SWAP ; SOME ; SWAP ; CAR ; PAIR ; SOME } ;
                         NIL operation ;
                         PAIR } ;
                     UNPAIR ;
                     DIG 2 ;
                     CDR ;
                     DIG 2 ;
                     PAIR ;
                     SWAP ;
                     PAIR }
                   { DIG 6 ;
                     DROP ;
                     DIG 2 ;
                     SWAP ;
                     DIG 2 ;
                     DUP 3 ;
                     DUP 3 ;
                     PAIR ;
                     DIG 4 ;
                     SWAP ;
                     EXEC ;
                     DUP ;
                     CDR ;
                     CAR ;
                     SENDER ;
                     COMPARE ;
                     EQ ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     CAR ;
                     DIG 7 ;
                     SWAP ;
                     EXEC ;
                     AND ;
                     IF { DUP ;
                          CDR ;
                          PUSH unit Unit ;
                          LEFT unit ;
                          LEFT (or unit unit) ;
                          PAIR ;
                          NOW ;
                          SOME ;
                          SWAP ;
                          DUP ;
                          DUG 2 ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CAR ;
                          PAIR ;
                          SWAP ;
                          DUP ;
                          DUG 2 ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CAR ;
                          PAIR ;
                          SWAP ;
                          DUP ;
                          DUG 2 ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CAR ;
                          PAIR ;
                          SWAP ;
                          DUP ;
                          DUG 2 ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CAR ;
                          PAIR ;
                          SWAP ;
                          DUP ;
                          DUG 2 ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CAR ;
                          PAIR ;
                          SWAP ;
                          DUP ;
                          DUG 2 ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CAR ;
                          PAIR ;
                          SWAP ;
                          DUP ;
                          DUG 2 ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CAR ;
                          PAIR ;
                          SWAP ;
                          DUP ;
                          DUG 2 ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CAR ;
                          PAIR ;
                          SWAP ;
                          DUP ;
                          DUG 2 ;
                          CDR ;
                          CDR ;
                          CAR ;
                          PAIR ;
                          SWAP ;
                          DUP ;
                          DUG 2 ;
                          CDR ;
                          CAR ;
                          PAIR ;
                          SWAP ;
                          CAR ;
                          PAIR ;
                          DUP 5 ;
                          CDR ;
                          CAR ;
                          DIG 2 ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CAR ;
                          PAIR ;
                          SENDER ;
                          DIG 3 ;
                          PAIR ;
                          PAIR ;
                          DIG 4 ;
                          SWAP ;
                          EXEC ;
                          DUP 4 ;
                          CDR ;
                          CDR ;
                          CDR ;
                          DUP 5 ;
                          CDR ;
                          CDR ;
                          CAR ;
                          DUP 5 ;
                          NONE (pair (or (or unit unit) (or unit unit))
                                     (pair address
                                           (pair bytes
                                                 (pair (option bytes)
                                                       (pair (option address)
                                                             (pair (option bytes)
                                                                   (pair (option bytes) (pair timestamp (pair nat (pair nat (pair nat (option timestamp)))))))))))) ;
                          SWAP ;
                          UPDATE ;
                          PAIR ;
                          DUP 5 ;
                          CDR ;
                          CAR ;
                          PAIR ;
                          DUP 5 ;
                          CAR ;
                          PAIR ;
                          DUP ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          DIG 5 ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CAR ;
                          DIG 4 ;
                          SOME ;
                          DIG 5 ;
                          UPDATE ;
                          PAIR ;
                          SWAP ;
                          DUP ;
                          DUG 2 ;
                          CDR ;
                          CDR ;
                          CAR ;
                          PAIR ;
                          SWAP ;
                          DUP ;
                          DUG 2 ;
                          CDR ;
                          CAR ;
                          PAIR ;
                          SWAP ;
                          CAR ;
                          PAIR ;
                          NIL operation ;
                          DIG 2 ;
                          CONS ;
                          PAIR }
                        { DROP 5 ; PUSH string "CANCEL_FAIL" ; FAILWITH } } }
               { DIG 9 ;
                 DROP ;
                 IF_LEFT
                   { DIG 5 ;
                     DROP ;
                     DIG 2 ;
                     SWAP ;
                     DIG 2 ;
                     DUP 3 ;
                     DUP 3 ;
                     PAIR ;
                     DIG 4 ;
                     SWAP ;
                     EXEC ;
                     DUP ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CAR ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     CDR ;
                     PUSH unit Unit ;
                     LEFT unit ;
                     LEFT (or unit unit) ;
                     PAIR ;
                     NOW ;
                     SOME ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CAR ;
                     PAIR ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CAR ;
                     PAIR ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CAR ;
                     PAIR ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CAR ;
                     PAIR ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CAR ;
                     PAIR ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CAR ;
                     PAIR ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CAR ;
                     PAIR ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CAR ;
                     PAIR ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     CDR ;
                     CDR ;
                     CAR ;
                     PAIR ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     CDR ;
                     CAR ;
                     PAIR ;
                     SWAP ;
                     CAR ;
                     PAIR ;
                     DUP 6 ;
                     CDR ;
                     CDR ;
                     CAR ;
                     DUP 6 ;
                     NONE (pair (or (or unit unit) (or unit unit))
                                (pair address
                                      (pair bytes
                                            (pair (option bytes)
                                                  (pair (option address)
                                                        (pair (option bytes)
                                                              (pair (option bytes) (pair timestamp (pair nat (pair nat (pair nat (option timestamp)))))))))))) ;
                     SWAP ;
                     UPDATE ;
                     DUP 7 ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CAR ;
                     DIG 2 ;
                     SOME ;
                     DIG 6 ;
                     UPDATE ;
                     PUSH int 1800 ;
                     DUP 5 ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CAR ;
                     ADD ;
                     NOW ;
                     COMPARE ;
                     GT ;
                     DUP 5 ;
                     CAR ;
                     DIG 11 ;
                     SWAP ;
                     EXEC ;
                     AND ;
                     IF { DIG 7 ;
                          DROP ;
                          DIG 7 ;
                          DROP ;
                          DUP 6 ;
                          CDR ;
                          CAR ;
                          DIG 3 ;
                          PAIR ;
                          DIG 3 ;
                          CDR ;
                          CAR ;
                          DIG 4 ;
                          PAIR ;
                          PAIR ;
                          DIG 4 ;
                          SWAP ;
                          EXEC ;
                          DUP 4 ;
                          CDR ;
                          CDR ;
                          CDR ;
                          DIG 3 ;
                          PAIR ;
                          DUP 4 ;
                          CDR ;
                          CAR ;
                          PAIR ;
                          DIG 3 ;
                          CAR ;
                          PAIR ;
                          DUP ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          DIG 3 ;
                          PAIR ;
                          SWAP ;
                          DUP ;
                          DUG 2 ;
                          CDR ;
                          CDR ;
                          CAR ;
                          PAIR ;
                          SWAP ;
                          DUP ;
                          DUG 2 ;
                          CDR ;
                          CAR ;
                          PAIR ;
                          SWAP ;
                          CAR ;
                          PAIR ;
                          NIL operation ;
                          DIG 2 ;
                          CONS ;
                          PAIR }
                        { PUSH int 1800 ;
                          DUP 5 ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CDR ;
                          CAR ;
                          ADD ;
                          NOW ;
                          COMPARE ;
                          GT ;
                          DUP 5 ;
                          CAR ;
                          DIG 10 ;
                          SWAP ;
                          EXEC ;
                          AND ;
                          IF { DIG 2 ;
                               DROP ;
                               DIG 6 ;
                               DROP ;
                               DUP 3 ;
                               CDR ;
                               CDR ;
                               CDR ;
                               CDR ;
                               CAR ;
                               IF_NONE { PUSH string "NO_TAKER" ; FAILWITH } {} ;
                               PUSH nat 10 ;
                               DUP 5 ;
                               CDR ;
                               CDR ;
                               CDR ;
                               CDR ;
                               CDR ;
                               CDR ;
                               CDR ;
                               CDR ;
                               CAR ;
                               EDIV ;
                               IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                               CAR ;
                               PUSH nat 2 ;
                               SWAP ;
                               DUP ;
                               DUG 2 ;
                               DUP 7 ;
                               CDR ;
                               CDR ;
                               CDR ;
                               CDR ;
                               CDR ;
                               CDR ;
                               CDR ;
                               CDR ;
                               CAR ;
                               SUB ;
                               ABS ;
                               EDIV ;
                               IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                               CAR ;
                               DUP 8 ;
                               CDR ;
                               CAR ;
                               DIG 2 ;
                               PAIR ;
                               DUP 8 ;
                               CDR ;
                               CDR ;
                               CDR ;
                               CDR ;
                               CDR ;
                               DUP 8 ;
                               PAIR ;
                               PAIR ;
                               DUP 9 ;
                               SWAP ;
                               EXEC ;
                               DUP 8 ;
                               CDR ;
                               CAR ;
                               DUP 3 ;
                               PAIR ;
                               SENDER ;
                               DUP 9 ;
                               PAIR ;
                               PAIR ;
                               DUP 10 ;
                               SWAP ;
                               EXEC ;
                               DUP 9 ;
                               CDR ;
                               CAR ;
                               DIG 3 ;
                               PAIR ;
                               DUP 4 ;
                               DUP 9 ;
                               PAIR ;
                               PAIR ;
                               DUP 10 ;
                               SWAP ;
                               EXEC ;
                               NIL operation ;
                               DUP 10 ;
                               CDR ;
                               CAR ;
                               DIG 8 ;
                               CDR ;
                               CDR ;
                               CDR ;
                               CDR ;
                               CDR ;
                               CDR ;
                               CDR ;
                               CDR ;
                               CDR ;
                               CDR ;
                               CAR ;
                               PAIR ;
                               DIG 5 ;
                               DIG 8 ;
                               PAIR ;
                               PAIR ;
                               DIG 8 ;
                               SWAP ;
                               EXEC ;
                               CONS ;
                               DUP 7 ;
                               CDR ;
                               CDR ;
                               CDR ;
                               DIG 6 ;
                               PAIR ;
                               DUP 7 ;
                               CDR ;
                               CAR ;
                               PAIR ;
                               DIG 6 ;
                               CAR ;
                               PAIR ;
                               DUP ;
                               CDR ;
                               CDR ;
                               CDR ;
                               CDR ;
                               DIG 6 ;
                               PAIR ;
                               SWAP ;
                               DUP ;
                               DUG 2 ;
                               CDR ;
                               CDR ;
                               CAR ;
                               PAIR ;
                               SWAP ;
                               DUP ;
                               DUG 2 ;
                               CDR ;
                               CAR ;
                               PAIR ;
                               SWAP ;
                               CAR ;
                               PAIR ;
                               SWAP ;
                               DIG 2 ;
                               CONS ;
                               DIG 2 ;
                               CONS ;
                               DIG 2 ;
                               CONS ;
                               PAIR }
                             { PUSH int 1800 ;
                               DUP 5 ;
                               CDR ;
                               CDR ;
                               CDR ;
                               CDR ;
                               CDR ;
                               CDR ;
                               CDR ;
                               CAR ;
                               ADD ;
                               NOW ;
                               COMPARE ;
                               GT ;
                               DUP 5 ;
                               CAR ;
                               DIG 9 ;
                               SWAP ;
                               EXEC ;
                               AND ;
                               IF { PUSH nat 10 ;
                                    DUP 5 ;
                                    CDR ;
                                    CDR ;
                                    CDR ;
                                    CDR ;
                                    CDR ;
                                    CDR ;
                                    CDR ;
                                    CDR ;
                                    CDR ;
                                    CDR ;
                                    CAR ;
                                    EDIV ;
                                    IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                                    CAR ;
                                    PUSH nat 2 ;
                                    SWAP ;
                                    DUP ;
                                    DUG 2 ;
                                    DUP 7 ;
                                    CDR ;
                                    CDR ;
                                    CDR ;
                                    CDR ;
                                    CDR ;
                                    CDR ;
                                    CDR ;
                                    CDR ;
                                    CDR ;
                                    CDR ;
                                    CAR ;
                                    SUB ;
                                    ABS ;
                                    EDIV ;
                                    IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                                    CAR ;
                                    DUP 8 ;
                                    CDR ;
                                    CAR ;
                                    DIG 2 ;
                                    PAIR ;
                                    DUP 8 ;
                                    CDR ;
                                    CDR ;
                                    CDR ;
                                    CDR ;
                                    CDR ;
                                    DUP 8 ;
                                    PAIR ;
                                    PAIR ;
                                    DUP 9 ;
                                    SWAP ;
                                    EXEC ;
                                    DUP 8 ;
                                    CDR ;
                                    CAR ;
                                    DUP 3 ;
                                    PAIR ;
                                    SENDER ;
                                    DUP 9 ;
                                    PAIR ;
                                    PAIR ;
                                    DUP 10 ;
                                    SWAP ;
                                    EXEC ;
                                    DUP 9 ;
                                    CDR ;
                                    CAR ;
                                    DIG 3 ;
                                    PAIR ;
                                    DUP 7 ;
                                    CDR ;
                                    CAR ;
                                    DUP 9 ;
                                    PAIR ;
                                    PAIR ;
                                    DUP 10 ;
                                    SWAP ;
                                    EXEC ;
                                    NIL operation ;
                                    DUP 10 ;
                                    CDR ;
                                    CAR ;
                                    DIG 7 ;
                                    PAIR ;
                                    DIG 7 ;
                                    CDR ;
                                    CAR ;
                                    DIG 8 ;
                                    PAIR ;
                                    PAIR ;
                                    DIG 8 ;
                                    SWAP ;
                                    EXEC ;
                                    CONS ;
                                    DUP 7 ;
                                    CDR ;
                                    CDR ;
                                    CDR ;
                                    DIG 6 ;
                                    PAIR ;
                                    DUP 7 ;
                                    CDR ;
                                    CAR ;
                                    PAIR ;
                                    DIG 6 ;
                                    CAR ;
                                    PAIR ;
                                    DUP ;
                                    CDR ;
                                    CDR ;
                                    CDR ;
                                    CDR ;
                                    DIG 6 ;
                                    PAIR ;
                                    SWAP ;
                                    DUP ;
                                    DUG 2 ;
                                    CDR ;
                                    CDR ;
                                    CAR ;
                                    PAIR ;
                                    SWAP ;
                                    DUP ;
                                    DUG 2 ;
                                    CDR ;
                                    CAR ;
                                    PAIR ;
                                    SWAP ;
                                    CAR ;
                                    PAIR ;
                                    SWAP ;
                                    DIG 2 ;
                                    CONS ;
                                    DIG 2 ;
                                    CONS ;
                                    DIG 2 ;
                                    CONS ;
                                    PAIR }
                                  { DROP 7 ; PUSH string "LIQUIDATE_FAIL" ; FAILWITH } } } }
                   { DIG 3 ;
                     DROP ;
                     DIG 5 ;
                     DROP ;
                     DIG 5 ;
                     DROP ;
                     DIG 5 ;
                     DROP ;
                     DIG 2 ;
                     SWAP ;
                     DIG 2 ;
                     PUSH string "Guess must be greater than 0" ;
                     PUSH nat 0 ;
                     DUP 4 ;
                     CDR ;
                     CDR ;
                     COMPARE ;
                     GT ;
                     PAIR ;
                     DUP 6 ;
                     SWAP ;
                     EXEC ;
                     DROP ;
                     PUSH string "Guess must be less than 6" ;
                     PUSH nat 6 ;
                     DUP 4 ;
                     CDR ;
                     CDR ;
                     COMPARE ;
                     LT ;
                     PAIR ;
                     DUP 6 ;
                     SWAP ;
                     EXEC ;
                     DROP ;
                     PUSH string "Min bet is 10" ;
                     PUSH nat 9 ;
                     DUP 4 ;
                     CDR ;
                     CAR ;
                     COMPARE ;
                     GT ;
                     PAIR ;
                     DIG 5 ;
                     SWAP ;
                     EXEC ;
                     DROP ;
                     NONE timestamp ;
                     DUP 3 ;
                     CDR ;
                     CDR ;
                     DUP 4 ;
                     CDR ;
                     CAR ;
                     DUP ;
                     PUSH nat 100 ;
                     DIG 3 ;
                     DIG 3 ;
                     PUSH nat 600 ;
                     MUL ;
                     EDIV ;
                     IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                     CAR ;
                     EDIV ;
                     IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                     CAR ;
                     SUB ;
                     ABS ;
                     PAIR ;
                     DUP 3 ;
                     CDR ;
                     CDR ;
                     PAIR ;
                     DUP 3 ;
                     CDR ;
                     CAR ;
                     PAIR ;
                     NOW ;
                     PAIR ;
                     NONE bytes ;
                     PAIR ;
                     NONE bytes ;
                     PAIR ;
                     NONE address ;
                     PAIR ;
                     NONE bytes ;
                     PAIR ;
                     DUP 3 ;
                     CAR ;
                     PAIR ;
                     SENDER ;
                     PAIR ;
                     PUSH unit Unit ;
                     RIGHT unit ;
                     LEFT (or unit unit) ;
                     PAIR ;
                     DUP 4 ;
                     CDR ;
                     CAR ;
                     DIG 3 ;
                     CDR ;
                     CAR ;
                     PAIR ;
                     DIG 2 ;
                     SENDER ;
                     PAIR ;
                     PAIR ;
                     DIG 3 ;
                     SWAP ;
                     EXEC ;
                     DUP 3 ;
                     CDR ;
                     CDR ;
                     CDR ;
                     DUP 4 ;
                     CDR ;
                     CDR ;
                     CAR ;
                     DIG 3 ;
                     SOME ;
                     DUP 5 ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CAR ;
                     UPDATE ;
                     PAIR ;
                     DUP 3 ;
                     CDR ;
                     CAR ;
                     PAIR ;
                     DUP 3 ;
                     CAR ;
                     PAIR ;
                     DUP ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     PUSH nat 1 ;
                     DIG 4 ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CAR ;
                     ADD ;
                     PAIR ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     CDR ;
                     CDR ;
                     CDR ;
                     CAR ;
                     PAIR ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     CDR ;
                     CDR ;
                     CAR ;
                     PAIR ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     CDR ;
                     CAR ;
                     PAIR ;
                     SWAP ;
                     CAR ;
                     PAIR ;
                     NIL operation ;
                     DIG 2 ;
                     CONS ;
                     PAIR } } }
           { DIG 6 ;
             DROP ;
             DIG 9 ;
             DROP ;
             IF_LEFT
               { DIG 8 ;
                 DROP ;
                 DIG 2 ;
                 SWAP ;
                 DIG 2 ;
                 DUP 3 ;
                 DUP 3 ;
                 CAR ;
                 PAIR ;
                 DIG 4 ;
                 SWAP ;
                 EXEC ;
                 DUP ;
                 CDR ;
                 CDR ;
                 CDR ;
                 CDR ;
                 CAR ;
                 IF_NONE { PUSH string "NO_TAKER" ; FAILWITH } {} ;
                 SWAP ;
                 DUP ;
                 DUG 2 ;
                 CDR ;
                 CDR ;
                 CDR ;
                 CDR ;
                 CDR ;
                 CAR ;
                 IF_NONE { PUSH string "NO_TAKER_HASH" ; FAILWITH } {} ;
                 DUP 5 ;
                 CDR ;
                 DUP 4 ;
                 CDR ;
                 CDR ;
                 CAR ;
                 PAIR ;
                 DUP 8 ;
                 SWAP ;
                 EXEC ;
                 DUP 4 ;
                 CDR ;
                 CAR ;
                 SENDER ;
                 COMPARE ;
                 EQ ;
                 DUP 5 ;
                 CAR ;
                 DIG 12 ;
                 SWAP ;
                 EXEC ;
                 AND ;
                 AND ;
                 IF { DROP 2 ;
                      SWAP ;
                      DROP ;
                      DIG 3 ;
                      DROP ;
                      DIG 3 ;
                      DROP ;
                      DIG 3 ;
                      DROP ;
                      DUP 3 ;
                      CDR ;
                      CDR ;
                      CDR ;
                      DUP 4 ;
                      CDR ;
                      CDR ;
                      CAR ;
                      DIG 2 ;
                      CDR ;
                      PUSH unit Unit ;
                      LEFT unit ;
                      RIGHT (or unit unit) ;
                      PAIR ;
                      DUP ;
                      CDR ;
                      CDR ;
                      CDR ;
                      CDR ;
                      DUP 5 ;
                      CDR ;
                      SOME ;
                      PAIR ;
                      SWAP ;
                      DUP ;
                      DUG 2 ;
                      CDR ;
                      CDR ;
                      CAR ;
                      PAIR ;
                      SWAP ;
                      DUP ;
                      DUG 2 ;
                      CDR ;
                      CAR ;
                      PAIR ;
                      SWAP ;
                      CAR ;
                      PAIR ;
                      SOME ;
                      DIG 3 ;
                      CAR ;
                      UPDATE ;
                      PAIR ;
                      SWAP ;
                      DUP ;
                      DUG 2 ;
                      CDR ;
                      CAR ;
                      PAIR ;
                      SWAP ;
                      CAR ;
                      PAIR ;
                      NIL operation ;
                      PAIR }
                    { DUP 5 ;
                      CDR ;
                      SWAP ;
                      PAIR ;
                      DIG 6 ;
                      SWAP ;
                      EXEC ;
                      SWAP ;
                      SENDER ;
                      COMPARE ;
                      EQ ;
                      DUP 3 ;
                      CAR ;
                      DIG 8 ;
                      SWAP ;
                      EXEC ;
                      AND ;
                      AND ;
                      IF { CDR ;
                           PUSH unit Unit ;
                           LEFT unit ;
                           LEFT (or unit unit) ;
                           PAIR ;
                           DUP ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           DUP 4 ;
                           CDR ;
                           SOME ;
                           PAIR ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CAR ;
                           PAIR ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CAR ;
                           PAIR ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CAR ;
                           PAIR ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           CDR ;
                           CDR ;
                           CAR ;
                           PAIR ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           CDR ;
                           CAR ;
                           PAIR ;
                           SWAP ;
                           CAR ;
                           PAIR ;
                           NOW ;
                           SOME ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CAR ;
                           PAIR ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CAR ;
                           PAIR ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CAR ;
                           PAIR ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CAR ;
                           PAIR ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CAR ;
                           PAIR ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CAR ;
                           PAIR ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CAR ;
                           PAIR ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CAR ;
                           PAIR ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           CDR ;
                           CDR ;
                           CAR ;
                           PAIR ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           CDR ;
                           CAR ;
                           PAIR ;
                           SWAP ;
                           CAR ;
                           PAIR ;
                           DUP 4 ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           DIG 3 ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CAR ;
                           IF_NONE { PUSH string "NO_MAKER_SECRET" ; FAILWITH } {} ;
                           DUP 3 ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CAR ;
                           IF_NONE { PUSH string "NO_TAKER" ; FAILWITH } {} ;
                           DUP 4 ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CAR ;
                           IF_NONE { PUSH string "NO_TAKER_SECRET" ; FAILWITH } {} ;
                           DIG 2 ;
                           CONCAT ;
                           SHA256 ;
                           PUSH nat 2 ;
                           PUSH nat 30 ;
                           SLICE ;
                           IF_NONE { PUSH string "SLICE" ; FAILWITH } {} ;
                           PUSH bool True ;
                           PUSH bytes 0x2aaa ;
                           DUP 3 ;
                           COMPARE ;
                           LT ;
                           IF { SWAP ; DROP ; PUSH int 1 }
                              { PUSH bytes 0x5554 ;
                                DUP 3 ;
                                COMPARE ;
                                LT ;
                                IF { SWAP ; DROP ; PUSH int 2 }
                                   { PUSH bytes 0x7ffe ;
                                     DUP 3 ;
                                     COMPARE ;
                                     LT ;
                                     IF { SWAP ; DROP ; PUSH int 3 }
                                        { PUSH bytes 0xaaa8 ;
                                          DUP 3 ;
                                          COMPARE ;
                                          LT ;
                                          IF { SWAP ; DROP ; PUSH int 4 }
                                             { PUSH bytes 0xd552 ;
                                               DIG 2 ;
                                               COMPARE ;
                                               LT ;
                                               IF { PUSH int 5 } { PUSH int 6 } } } } } ;
                           ABS ;
                           DUP 5 ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CAR ;
                           COMPARE ;
                           GE ;
                           COMPARE ;
                           EQ ;
                           IF { DROP ;
                                NIL operation ;
                                DIG 3 ;
                                CDR ;
                                CAR ;
                                DUP 4 ;
                                CDR ;
                                CDR ;
                                CDR ;
                                CDR ;
                                CDR ;
                                CDR ;
                                CDR ;
                                CDR ;
                                CDR ;
                                CDR ;
                                CAR ;
                                DUP 5 ;
                                CDR ;
                                CDR ;
                                CDR ;
                                CDR ;
                                CDR ;
                                CDR ;
                                CDR ;
                                CDR ;
                                CAR ;
                                ADD ;
                                PAIR ;
                                DIG 3 ;
                                CDR ;
                                CAR ;
                                DIG 3 ;
                                PAIR ;
                                PAIR ;
                                DIG 5 ;
                                SWAP ;
                                EXEC ;
                                CONS }
                              { NIL operation ;
                                DIG 4 ;
                                CDR ;
                                CAR ;
                                DUP 5 ;
                                CDR ;
                                CDR ;
                                CDR ;
                                CDR ;
                                CDR ;
                                CDR ;
                                CDR ;
                                CDR ;
                                CDR ;
                                CDR ;
                                CAR ;
                                DIG 5 ;
                                CDR ;
                                CDR ;
                                CDR ;
                                CDR ;
                                CDR ;
                                CDR ;
                                CDR ;
                                CDR ;
                                CAR ;
                                ADD ;
                                PAIR ;
                                DIG 2 ;
                                DIG 3 ;
                                PAIR ;
                                PAIR ;
                                DIG 5 ;
                                SWAP ;
                                EXEC ;
                                CONS } ;
                           DUP 4 ;
                           CDR ;
                           CDR ;
                           CDR ;
                           DUP 5 ;
                           CDR ;
                           CDR ;
                           CAR ;
                           DUP 5 ;
                           CAR ;
                           NONE (pair (or (or unit unit) (or unit unit))
                                      (pair address
                                            (pair bytes
                                                  (pair (option bytes)
                                                        (pair (option address)
                                                              (pair (option bytes)
                                                                    (pair (option bytes) (pair timestamp (pair nat (pair nat (pair nat (option timestamp)))))))))))) ;
                           SWAP ;
                           UPDATE ;
                           PAIR ;
                           DUP 5 ;
                           CDR ;
                           CAR ;
                           PAIR ;
                           DUP 5 ;
                           CAR ;
                           PAIR ;
                           DUP ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CDR ;
                           DIG 5 ;
                           CDR ;
                           CDR ;
                           CDR ;
                           CAR ;
                           DIG 4 ;
                           SOME ;
                           DIG 5 ;
                           CAR ;
                           UPDATE ;
                           PAIR ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           CDR ;
                           CDR ;
                           CAR ;
                           PAIR ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           CDR ;
                           CAR ;
                           PAIR ;
                           SWAP ;
                           CAR ;
                           PAIR ;
                           SWAP ;
                           PAIR }
                         { DROP 5 ; PUSH string "RESOLVE_FAIL" ; FAILWITH } } }
               { DIG 4 ;
                 DROP ;
                 DIG 5 ;
                 DROP ;
                 DIG 5 ;
                 DROP ;
                 DIG 2 ;
                 SWAP ;
                 DIG 2 ;
                 DUP 3 ;
                 DUP 3 ;
                 CAR ;
                 PAIR ;
                 DIG 4 ;
                 SWAP ;
                 EXEC ;
                 DUP ;
                 CAR ;
                 DIG 6 ;
                 SWAP ;
                 EXEC ;
                 IF { DUP ;
                      CDR ;
                      PUSH unit Unit ;
                      RIGHT unit ;
                      RIGHT (or unit unit) ;
                      PAIR ;
                      DUP ;
                      CDR ;
                      CDR ;
                      CDR ;
                      CDR ;
                      CDR ;
                      SENDER ;
                      SOME ;
                      PAIR ;
                      SWAP ;
                      DUP ;
                      DUG 2 ;
                      CDR ;
                      CDR ;
                      CDR ;
                      CAR ;
                      PAIR ;
                      SWAP ;
                      DUP ;
                      DUG 2 ;
                      CDR ;
                      CDR ;
                      CAR ;
                      PAIR ;
                      SWAP ;
                      DUP ;
                      DUG 2 ;
                      CDR ;
                      CAR ;
                      PAIR ;
                      SWAP ;
                      CAR ;
                      PAIR ;
                      DUP ;
                      CDR ;
                      CDR ;
                      CDR ;
                      CDR ;
                      CDR ;
                      CDR ;
                      DUP 5 ;
                      CDR ;
                      SOME ;
                      PAIR ;
                      SWAP ;
                      DUP ;
                      DUG 2 ;
                      CDR ;
                      CDR ;
                      CDR ;
                      CDR ;
                      CAR ;
                      PAIR ;
                      SWAP ;
                      DUP ;
                      DUG 2 ;
                      CDR ;
                      CDR ;
                      CDR ;
                      CAR ;
                      PAIR ;
                      SWAP ;
                      DUP ;
                      DUG 2 ;
                      CDR ;
                      CDR ;
                      CAR ;
                      PAIR ;
                      SWAP ;
                      DUP ;
                      DUG 2 ;
                      CDR ;
                      CAR ;
                      PAIR ;
                      SWAP ;
                      CAR ;
                      PAIR ;
                      DUP ;
                      CDR ;
                      CDR ;
                      CDR ;
                      CDR ;
                      CDR ;
                      CDR ;
                      CDR ;
                      CDR ;
                      NOW ;
                      PAIR ;
                      SWAP ;
                      DUP ;
                      DUG 2 ;
                      CDR ;
                      CDR ;
                      CDR ;
                      CDR ;
                      CDR ;
                      CDR ;
                      CAR ;
                      PAIR ;
                      SWAP ;
                      DUP ;
                      DUG 2 ;
                      CDR ;
                      CDR ;
                      CDR ;
                      CDR ;
                      CDR ;
                      CAR ;
                      PAIR ;
                      SWAP ;
                      DUP ;
                      DUG 2 ;
                      CDR ;
                      CDR ;
                      CDR ;
                      CDR ;
                      CAR ;
                      PAIR ;
                      SWAP ;
                      DUP ;
                      DUG 2 ;
                      CDR ;
                      CDR ;
                      CDR ;
                      CAR ;
                      PAIR ;
                      SWAP ;
                      DUP ;
                      DUG 2 ;
                      CDR ;
                      CDR ;
                      CAR ;
                      PAIR ;
                      SWAP ;
                      DUP ;
                      DUG 2 ;
                      CDR ;
                      CAR ;
                      PAIR ;
                      SWAP ;
                      CAR ;
                      PAIR ;
                      DUP 5 ;
                      CDR ;
                      CAR ;
                      DIG 2 ;
                      CDR ;
                      CDR ;
                      CDR ;
                      CDR ;
                      CDR ;
                      CDR ;
                      CDR ;
                      CDR ;
                      CDR ;
                      CDR ;
                      CAR ;
                      PAIR ;
                      DIG 2 ;
                      SENDER ;
                      PAIR ;
                      PAIR ;
                      DIG 4 ;
                      SWAP ;
                      EXEC ;
                      DUP 4 ;
                      CDR ;
                      CDR ;
                      CDR ;
                      DUP 5 ;
                      CDR ;
                      CDR ;
                      CAR ;
                      DIG 3 ;
                      SOME ;
                      DIG 4 ;
                      CAR ;
                      UPDATE ;
                      PAIR ;
                      DUP 3 ;
                      CDR ;
                      CAR ;
                      PAIR ;
                      DIG 2 ;
                      CAR ;
                      PAIR ;
                      NIL operation ;
                      DIG 2 ;
                      CONS ;
                      PAIR }
                    { DROP 5 ; PUSH string "STAGE_MISMATCH" ; FAILWITH } } } } }
